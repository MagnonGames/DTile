<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<dom-module id="dtile-new-map-dialog">
	<template>
		<style>
			:host {
				display: block;
			}

			.line {
				display: block;
			}

			.line > paper-input {
				display: inline-block;
			}
		</style>

		<paper-dialog opened="{{opened}}" with-backdrop>
			<h2>Create New Map</h2>
			<paper-input id="nameInput" label="Name" autofocus auto-validate
				error-message="Map has to have a name." required
				value="{{mapName}}"></paper-input>
			<div class="line">
				<paper-input id="mapWidthInput" label="Map Width (tiles)" autofocus
					auto-validate required value="{{mapWidth}}" type="number"></paper-input>
				<paper-input id="mapHeightInput" label="Map Height (tiles)" autofocus
					auto-validate required value="{{mapHeight}}" type="number"></paper-input>
			</div>
			<div class="line">
				<paper-input id="tileWidthInput" label="Tile Width (px)" autofocus
					auto-validate required value="{{tileWidth}}" type="number"></paper-input>
				<paper-input id="tileWidthInput" label="Tile Height (px)" autofocus
					auto-validate required value="{{tileHeight}}" type="number"></paper-input>
			</div>
			<div class="buttons">
				<paper-button dialog-dismiss>Cancel</paper-button>
				<paper-button dialog-confirm disabled="[[!_inputValid]]" on-tap="_fireCreate">Create Map</paper-button>
			</div>
		</paper-dialog>
	</template>

	<script>
		Polymer({
			is: "dtile-new-map-dialog",

			properties: {
				opened: {
					type: Boolean,
					value: false,
					reflectToAttribute: true
				},
				mapName: String,
				mapWidth: {
					type: Number,
					value: 50
				},
				mapHeight: {
					type: Number,
					value: 50
				},
				tileWidth: {
					type: Number,
					value: 16
				},
				tileHeight: {
					type: Number,
					value: 16
				},

				_inputValid: Boolean
			},

			observers: [
				"_verifyInput(mapName, mapWidth, mapHeight, tileWidth, tileHeight)"
			],

			open() {
				this.opened = true;
			},

			reset() {
				this.mapName = "";
				this.mapWidth = this.mapHeight = 50;
				this.tileWidth = this.tileHeight = 16;
			},

			_fireCreate() {
				this.fire("add-map", {
					name: this.mapName,
					width: this.mapWidth,
					height: this.mapHeight,
					tileWidth: this.tileWidth,
					tileHeight: this.tileHeight
				});
				this.reset();
			},

			_verifyInput(mapName, mapWidth, mapHeight, tileWidth, tileHeight) {
				this._inputValid = mapName.length > 0 &&
					mapWidth > 0 && mapHeight > 0 &&
					tileWidth > 0 && tileHeight > 0;
			}
		});
	</script>
</dom-module>
